/*
 * File: app/view/InstitucionesWinViewController14.js
 *
 * This file was generated by Sencha Architect
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.5.x Classic library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.5.x Classic. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('cartera.view.InstitucionesWinViewController14', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.correoinswin',

    onbtnGuardarCo: function(button, e, eOpts) {

        var id_institucion = Ext._id_institucion;
        var id_ciclo_escolar=Ext._id_ciclo_escolar;
        var id_alumno =records[0].data.id_alumno;
        var id_status_ciclo =records[0].data.id_status_ciclo;
        var grado =records[0].data.grado;
        var id_nivel_educativo=records[0].data.id_nivel_educativo;
        var correo =Ext.getCmp('cmbCorreoIns').getValue();
        var win = button.up('window');
        console.log(correo);


        // ENVIAR EL CARNET DE INSCRIPCIÓN
        if(records[0].data.id_carnet_inscripcion===0){
            Ext.MessageBox.show({
                title : 'Advertencia',
                buttons : Ext.MessageBox.OK,
                msg : 'No se ha generado carnet para el alumno seleccionado.',
                icon : Ext.Msg.ERROR
            });
        }else{



            new Ext.Window({
                title : "CARNET DE INSCRIPCIÓN",
                width : 990,
                maximizable: true,
                modal: true,
                height: 700,
                layout : 'fit',
                items : [{
                    xtype : "component",
                    autoEl : {
                        tag : "iframe",
                        src : "pdf/pdf_CarnetInscripcionEnviar.php?id_institucion="+id_institucion+"&id_ciclo_escolar="+id_ciclo_escolar+"&correo="+correo+"&id_alumno="+id_alumno+"&id_status_ciclo="+id_status_ciclo+"&grado="+grado+"&id_nivel_educativo="+id_nivel_educativo

                    }
                }]
            }).show();

            Ext.MessageBox.show({
                title : 'Información',
                buttons : Ext.MessageBox.OK,
                msg : 'Se ha enviado el carnet de inscripción.',
                icon : Ext.Msg.INFO

            });

            win.close();


        }




    },

    onbtnCancelarCo: function(button, e, eOpts) {
        button.up('window').close();
    },

    onCarnetsWinAfterRender: function(component, eOpts) {

        Ext._id_alumno=records[0].data.id_alumno;
        Ext.getStore('CorreoStore').load({
            params:{
                'id_ins': Ext._id_institucion,
                'id_ciclo_escolar': Ext._id_ciclo_escolar,
                'id_alumno': Ext._id_alumno
            },
        });

        Ext.getStore('cmbTipoMovimientoStore').load({
            params:{
                'id_ins': Ext._id_institucion,
            },
        });


    }

});
