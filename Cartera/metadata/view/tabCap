{
    "type": "Ext.panel.Panel",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "closable": true,
        "designer|userAlias": "tabCap",
        "designer|userClassName": "tabCap",
        "height": 630,
        "id": "tabCap",
        "itemId": "tabCap",
        "layout": "fit",
        "title": "Captura de Conteo Físico",
        "width": 829
    },
    "configAlternates": {
        "closable": "boolean",
        "designer|userAlias": "string",
        "designer|userClassName": "string",
        "height": "auto",
        "id": "string",
        "itemId": "string",
        "layout": "string",
        "title": "string",
        "width": "auto"
    },
    "name": "tabArtLis1",
    "designerId": "64847918-1edd-4165-a158-31044fb47e31",
    "viewControllerInstanceId": "86bfb894-1d0d-4cf3-b176-2209a6414402",
    "viewModelInstanceId": "e061dbe2-bcb5-4061-aa41-dfe2d0329adf",
    "cn": [
        {
            "type": "Ext.toolbar.Toolbar",
            "reference": {
                "name": "dockedItems",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "dock": "top"
            },
            "configAlternates": {
                "dock": "string"
            },
            "name": "MyToolbar1",
            "designerId": "de112df2-992b-414d-8bab-f74d4241530f",
            "cn": [
                {
                    "type": "Ext.button.Button",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": 50,
                        "icon": "resources/images/pdf.png",
                        "iconAlign": "top",
                        "id": "btnImpCap",
                        "itemId": "btnImprimir",
                        "layout|flex": null,
                        "scale": "large",
                        "width": 50
                    },
                    "configAlternates": {
                        "height": "auto",
                        "icon": "string",
                        "iconAlign": "string",
                        "id": "string",
                        "itemId": "string",
                        "layout|flex": "number",
                        "scale": "string",
                        "width": "auto"
                    },
                    "name": "MyButton1",
                    "designerId": "811d43f1-8e78-477d-b8a5-efc50ff4547b"
                },
                {
                    "type": "Ext.button.Button",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": 50,
                        "icon": "resources/images/excel.png",
                        "iconAlign": "bottom",
                        "id": "btnExcelCap",
                        "itemId": "btnExcelCap",
                        "layout|flex": null,
                        "scale": "large",
                        "width": 50
                    },
                    "configAlternates": {
                        "iconCls": "binding",
                        "height": "auto",
                        "icon": "string",
                        "iconAlign": "string",
                        "id": "string",
                        "itemId": "string",
                        "layout|flex": "number",
                        "scale": "string",
                        "width": "auto"
                    },
                    "name": "MyButton2",
                    "designerId": "5c738f24-0b53-45fc-bf1e-dbfb59071519"
                }
            ]
        },
        {
            "type": "Ext.grid.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "id": "GridArticulos",
                "store": "ArticulosStore"
            },
            "configAlternates": {
                "store": "store",
                "id": "string"
            },
            "name": "MyGridPanel",
            "designerId": "73ad0975-9c83-42e9-82a9-363e6d37b875",
            "cn": [
                {
                    "type": "Ext.grid.column.Number",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "id_articulo",
                        "format": "0",
                        "hidden": true,
                        "menuDisabled": true,
                        "text": "id_articulo"
                    },
                    "configAlternates": {
                        "dataIndex": "datafield",
                        "hidden": "boolean",
                        "menuDisabled": "boolean",
                        "text": "string",
                        "format": "string"
                    },
                    "name": "MyNumberColumn1",
                    "designerId": "881076ad-910e-471e-adc9-f2183d196211"
                },
                {
                    "type": "Ext.grid.column.Number",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "consec",
                        "format": "00000",
                        "menuDisabled": true,
                        "text": "Consec"
                    },
                    "configAlternates": {
                        "dataIndex": "datafield",
                        "menuDisabled": "boolean",
                        "text": "string",
                        "format": "string"
                    },
                    "name": "MyNumberColumn",
                    "designerId": "234e13e7-6d23-4729-b74b-25520be37329"
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "gpo_descrip",
                        "menuDisabled": true,
                        "text": "Grupo",
                        "width": 200
                    },
                    "configAlternates": {
                        "dataIndex": "datafield",
                        "text": "string",
                        "menuDisabled": "boolean",
                        "width": "auto"
                    },
                    "name": "MyColumn",
                    "designerId": "cf90c3ad-5ecf-4347-bba5-62905c598f06"
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "codigob",
                        "menuDisabled": true,
                        "text": "Cod. Barra",
                        "width": 200
                    },
                    "configAlternates": {
                        "dataIndex": "datafield",
                        "text": "string",
                        "menuDisabled": "boolean",
                        "width": "auto"
                    },
                    "name": "MyColumn4",
                    "designerId": "e23c0d43-c365-41dc-a1e9-cf1d2f7c4324"
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "descrip",
                        "menuDisabled": true,
                        "text": "Artículo",
                        "width": 400
                    },
                    "configAlternates": {
                        "dataIndex": "datafield",
                        "text": "string",
                        "menuDisabled": "boolean",
                        "width": "auto"
                    },
                    "name": "MyColumn3",
                    "designerId": "9965698a-d0ca-42d6-9214-8acbb7c51b9d"
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "menuDisabled": true,
                        "text": "Físico"
                    },
                    "configAlternates": {
                        "dataIndex": "datafield",
                        "text": "string",
                        "menuDisabled": "boolean"
                    },
                    "name": "MyColumn2",
                    "designerId": "01d3760c-938f-48bf-bffd-9ff69396f925",
                    "cn": [
                        {
                            "type": "Ext.grid.column.Number",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "align": "end",
                                "dataIndex": "exi_fis",
                                "id": "existencia",
                                "menuDisabled": true,
                                "text": "Existencia"
                            },
                            "configAlternates": {
                                "dataIndex": "datafield",
                                "text": "string",
                                "menuDisabled": "boolean",
                                "align": "string",
                                "id": "string"
                            },
                            "name": "MyNumberColumn4",
                            "designerId": "10bcd2fe-c04d-466e-98fa-c994e9c7bad9",
                            "cn": [
                                {
                                    "type": "Ext.form.field.Number",
                                    "reference": {
                                        "name": "editor",
                                        "type": "object"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "allowBlank": false,
                                        "allowDecimals": false,
                                        "allowExponential": false,
                                        "enableKeyEvents": true,
                                        "enforceMaxLength": true,
                                        "hideTrigger": true,
                                        "id": "txtCapFis",
                                        "maxLength": 6,
                                        "minValue": 0,
                                        "name": "Fisico"
                                    },
                                    "configAlternates": {
                                        "enforceMaxLength": "boolean",
                                        "id": "string",
                                        "maxLength": "number",
                                        "name": "string",
                                        "allowBlank": "boolean",
                                        "hideTrigger": "boolean",
                                        "minValue": "number",
                                        "allowDecimals": "boolean",
                                        "allowExponential": "boolean",
                                        "enableKeyEvents": "boolean"
                                    },
                                    "name": "MyNumberField",
                                    "designerId": "5824b8ea-c6f0-42ec-9af1-90330c1f0194",
                                    "cn": [
                                        {
                                            "type": "viewcontrollereventbinding",
                                            "reference": {
                                                "name": "listeners",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "fn": "onTxtCapFisFocusleave",
                                                "implHandler": [
                                                    "/*record = Ext.getCmp('GridArticulos').getSelectionModel().getSelection()[0];",
                                                    "        if(record.data.existe != record.data.exi_fis){",
                                                    "",
                                                    "            Ext._conteo  = Ext._conteo +1;",
                                                    "           // alert(Ext._conteo);",
                                                    "            switch(Ext._conteo){",
                                                    "                case 1:",
                                                    "                    Ext.MessageBox.show({",
                                                    "                    title: 'Conteo Fisico 1',",
                                                    "                    icon: Ext.MessageBox.WARNING,",
                                                    "                    msg: 'El fisico no coincide con la existencia, Capure nuevamente ',",
                                                    "                    buttons: Ext.MessageBox.OK,",
                                                    "                        fn: function() {",
                                                    "                            var f = Ext.getCmp('existencia');",
                                                    "                            console.log(f);",
                                                    "                        }",
                                                    "                    });",
                                                    "                    //Ext.getCmp('txtCapFis').focus(false, 200);",
                                                    "                break;",
                                                    "                case 2:",
                                                    "                    Ext.MessageBox.show({",
                                                    "                    title: 'Conteo Fisico 2',",
                                                    "                    icon: Ext.MessageBox.WARNING,",
                                                    "                    msg: 'El fisico no coincide con la existencia, Capure nuevamente ',",
                                                    "                    buttons: Ext.MessageBox.OK",
                                                    "                    });",
                                                    "                    Ext.getCmp('txtCapFis').focus(false, 200);",
                                                    "                break;",
                                                    "                case 3:",
                                                    "                //Ext.Msg.wait('Saving tables to disk...','File Copy');",
                                                    "                break;",
                                                    "                }",
                                                    "        }*/"
                                                ],
                                                "name": "focusleave",
                                                "scope": "me"
                                            },
                                            "configAlternates": {
                                                "fn": "string",
                                                "implHandler": "code",
                                                "name": "string",
                                                "scope": "string"
                                            },
                                            "name": "onTxtCapFisFocusleave",
                                            "designerId": "822ebe08-95c0-4dc9-bf48-de7f2c633c07"
                                        },
                                        {
                                            "type": "viewcontrollereventbinding",
                                            "reference": {
                                                "name": "listeners",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "fn": "onTxtCapFisFocusenter",
                                                "implHandler": [
                                                    "//Ext._conteo  = 1;"
                                                ],
                                                "name": "focusenter",
                                                "scope": "me"
                                            },
                                            "configAlternates": {
                                                "fn": "string",
                                                "implHandler": "code",
                                                "name": "string",
                                                "scope": "string"
                                            },
                                            "name": "onTxtCapFisFocusenter",
                                            "designerId": "1dcba306-6705-44bd-b4b9-0f90774eb65a"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "Ext.grid.column.Number",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "align": "end",
                                "dataIndex": "cto_fis",
                                "menuDisabled": true,
                                "text": "Costo"
                            },
                            "configAlternates": {
                                "dataIndex": "datafield",
                                "text": "string",
                                "menuDisabled": "boolean",
                                "align": "string"
                            },
                            "name": "MyNumberColumn5",
                            "designerId": "896a1fdc-22c1-44b7-9955-0ac29f74bb72"
                        }
                    ]
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "sta_descrip",
                        "menuDisabled": true,
                        "text": "Estatus"
                    },
                    "configAlternates": {
                        "dataIndex": "datafield",
                        "text": "string",
                        "menuDisabled": "boolean"
                    },
                    "name": "MyColumn1",
                    "designerId": "197cd823-ad50-406d-9a61-41fceefd32ce"
                },
                {
                    "type": "viewcontrollereventbinding",
                    "reference": {
                        "name": "listeners",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "fn": "onGridcolumnAfterRender",
                        "implHandler": [
                            "Ext.getStore('ArticulosStore').load();"
                        ],
                        "name": "afterrender",
                        "scope": "me"
                    },
                    "configAlternates": {
                        "fn": "string",
                        "implHandler": "code",
                        "name": "string",
                        "scope": "string"
                    },
                    "name": "onGridcolumnAfterRender",
                    "designerId": "a868327f-6c00-4641-ae8e-0deb4142e541"
                },
                {
                    "type": "Ext.grid.plugin.CellEditing",
                    "reference": {
                        "name": "plugins",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "clicksToEdit": 1
                    },
                    "configAlternates": {
                        "clicksToEdit": "number"
                    },
                    "name": "MyCellEditingPlugin",
                    "designerId": "0933e869-1317-4080-be6d-957ceb84e9c4",
                    "cn": [
                        {
                            "type": "viewcontrollereventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onCellEditingEdit",
                                "implHandler": [
                                    "var record = context.record,",
                                    "    column = context.column.fullColumnIndex, // columna a editar",
                                    "    row = context.rowIdx, // fila (record) a editar",
                                    "    nCto_uni = 0,",
                                    "    inputField; // txt en que se esta editando",
                                    "",
                                    "// si no se realizo una edicion (no se cambio el valor) entonces no se procesa el registro",
                                    "// Ejemplo: al cambiar entre filas",
                                    "if (context.originalValue === context.value) {",
                                    "    Ext._conteo = 1;",
                                    "    return;",
                                    "}",
                                    "",
                                    "if(record.data.existe != context.value) {",
                                    "    switch(Ext._conteo){",
                                    "        case 1:",
                                    "            // se revierten los cambios en el record, ya que este evento se ejecuta despues de",
                                    "            // modificar el record",
                                    "            record.reject();",
                                    "            ",
                                    "            Ext.MessageBox.show({",
                                    "                title: 'Primer Conteo',",
                                    "                icon: Ext.MessageBox.WARNING,",
                                    "                msg: 'El fisico no coincide con la existencia, Capure nuevamente ',",
                                    "                buttons: Ext.MessageBox.OK,",
                                    "                fn: function() {",
                                    "                    // se vuelve a ejecutar la edicion del record",
                                    "                    editor.startEditByPosition({",
                                    "                        column: column,",
                                    "                        row: row",
                                    "                    });",
                                    "                    // se asigna el valor que se valor que se intento editar, esto debido",
                                    "                    // que al revertir el record se pierde dicho valor",
                                    "                    inputField = context.column.getEditor();",
                                    "                    inputField.setValue(context.value);",
                                    "                    ",
                                    "                    Ext._conteo  = Ext._conteo + 1;",
                                    "                }",
                                    "            });",
                                    "            break;",
                                    "        case 2:",
                                    "            record.reject();",
                                    "            Ext.MessageBox.show({",
                                    "                title: 'Segundo Conteo',",
                                    "                icon: Ext.MessageBox.WARNING,",
                                    "                msg: 'El fisico no coincide con la existencia, Capure nuevamente ',",
                                    "                buttons: Ext.MessageBox.OK,",
                                    "                fn: function() {",
                                    "                    // se vuelve a ejecutar la edicion del record",
                                    "                    editor.startEditByPosition({",
                                    "                        column: column,",
                                    "                        row: row",
                                    "                    });",
                                    "                    // se asigna el valor que se valor que se intento editar, esto debido",
                                    "                    // que al revertir el record se pierde dicho valor",
                                    "                    inputField = context.column.getEditor();",
                                    "                    inputField.setValue(context.value);",
                                    "                    ",
                                    "                    Ext._conteo  = Ext._conteo + 1;",
                                    "                }",
                                    "            });",
                                    "            break;",
                                    "        default:",
                                    "            costear();",
                                    "            Ext._conteo = 1;",
                                    "            break;",
                                    "    }",
                                    "} else {",
                                    "    costear();",
                                    "    Ext._conteo = 1;",
                                    "}",
                                    "",
                                    "function costear() {",
                                    "    nCto_uni = record.data.costo/record.data.existe;",
                                    "    record.set('cto_fis', nCto_uni*record.data.exi_fis);",
                                    "    Ext.getStore('ArticulosStore').sync();",
                                    "    Ext.getCmp('GridArticulos').getView().refresh();",
                                    "}"
                                ],
                                "name": "edit",
                                "scope": "me"
                            },
                            "configAlternates": {
                                "fn": "string",
                                "implHandler": "code",
                                "name": "string",
                                "scope": "string"
                            },
                            "name": "onCellEditingEdit",
                            "designerId": "527dc4dd-def1-47a0-aaef-48a4ad32b6e8"
                        },
                        {
                            "type": "viewcontrollereventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onCellEditingValidateedit",
                                "implHandler": [
                                    "/*console.log('Validate');",
                                    "var record = Ext.getCmp('GridArticulos').getSelectionModel().getSelection()[0];",
                                    "console.log(arguments);",
                                    "if(record.data.existe != context.value) {",
                                    "    switch(Ext._conteo){",
                                    "        case 1:",
                                    "            Ext.MessageBox.show({",
                                    "                title: 'Primer Conteo',",
                                    "                icon: Ext.MessageBox.WARNING,",
                                    "                msg: 'El fisico no coincide con la existencia, Capure nuevamente ',",
                                    "                buttons: Ext.MessageBox.OK,",
                                    "                fn: function() {",
                                    "                    //Ext.getCmp('txtCapFis').focus();",
                                    "                    Ext._conteo  = Ext._conteo + 1;",
                                    "                }",
                                    "            });",
                                    "            return false;",
                                    "        case 2:",
                                    "            Ext.MessageBox.show({",
                                    "                title: 'Segundo Conteo',",
                                    "                icon: Ext.MessageBox.WARNING,",
                                    "                msg: 'El fisico no coincide con la existencia, Capure nuevamente ',",
                                    "                buttons: Ext.MessageBox.OK,",
                                    "                fn: function() {",
                                    "                   // Ext.getCmp('txtCapFis').focus();",
                                    "                    Ext._conteo  = Ext._conteo + 1;",
                                    "                }",
                                    "            });",
                                    "            return false;",
                                    "        default:",
                                    "            Ext._conteo = 1;",
                                    "            return true;",
                                    "            //break;",
                                    "",
                                    "    }",
                                    "}else{",
                                    "    return true;",
                                    "",
                                    "}*/",
                                    ""
                                ],
                                "name": "validateedit",
                                "scope": "me"
                            },
                            "configAlternates": {
                                "fn": "string",
                                "implHandler": "code",
                                "name": "string",
                                "scope": "string"
                            },
                            "name": "onCellEditingValidateedit",
                            "designerId": "cd19c24a-e2d0-43d6-88c5-d1dd6c984724"
                        }
                    ]
                }
            ]
        },
        {
            "type": "viewcontrollereventbinding",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "onTabCapAfterRender",
                "implHandler": [
                    "Ext.getStore('ConfigStore').load({",
                    "            callback: function (records, operation, success){",
                    "                if(success === true){",
                    "                    Ext.MessageBox.show({",
                    "                        title: 'Validacion',",
                    "                        icon: Ext.MessageBox.INFO,",
                    "                        msg: 'No se ha generado ningún archivo físico para este mes',",
                    "                        buttons: Ext.MessageBox.OK,",
                    "                         fn : function(btn)",
                    "                        {",
                    "                            // alert(btn);",
                    "                            if (btn == 'ok')",
                    "                            {",
                    "                                Ext.getCmp('tabCap').close();",
                    "",
                    "                            }",
                    "                        }",
                    "                    });",
                    "                    return false;",
                    "",
                    "                }",
                    "",
                    "            }",
                    "",
                    "",
                    "        });",
                    ""
                ],
                "name": "afterrender",
                "scope": "me"
            },
            "configAlternates": {
                "fn": "string",
                "implHandler": "code",
                "name": "string",
                "scope": "string"
            },
            "name": "onTabCapAfterRender",
            "designerId": "f26e0db8-f087-4f25-9c15-10022c11f7d4"
        }
    ]
}