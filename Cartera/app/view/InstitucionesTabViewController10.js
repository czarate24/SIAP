/*
 * File: app/view/InstitucionesTabViewController10.js
 *
 * This file was generated by Sencha Architect
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.5.x Classic library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.5.x Classic. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('cartera.view.InstitucionesTabViewController10', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.referenciastab',

    onBtnActualizarFamiliasACClick: function(button, e, eOpts) {
        Ext.getStore('CarnetsAlumnosStore').load({
            params:{
                'id_institucion': Ext._id_institucion,
                'id_ciclo_escolar': Ext._id_ciclo_escolar
            },
        });


        Ext.getStore('CarnetsColStore').load({
            params:{
                'id_alumno': 0,
                'id_institucion': Ext._id_institucion,
                'id_ciclo_escolar': Ext._id_ciclo_escolar

            }
        });

    },

    onTextfieldChange: function(field, newValue, oldValue, eOpts) {

        var busqueda = Ext.getCmp('txtBusAlumnoRef').getValue().toUpperCase();

        if(newValue === ''){

            Ext.getStore('BusAlumnoStore').clearFilter();

        }else {
            Ext.getStore('BusAlumnoStore').clearFilter();
            Ext.getStore('BusAlumnoStore').filter({
                filterFn: function(f) {
                    return f.get('ap_paterno').indexOf(busqueda) > -1;
                }
            });
        }

    },

    onGridcolumnAfterRender: function(component, eOpts) {

        Ext.getStore('BusAlumnoStore').load({
            params:{
                'id_institucion': Ext._id_institucion,
                'id_ciclo_escolar': Ext._id_ciclo_escolar
            }

        });


    },

    onGridFamiliasSelect: function(rowmodel, record, index, eOpts) {



        Ext.getStore('ReferenciasStore').load({
            params:{
                'id_alumno': record.data.id_alumno,
                'id_institucion': Ext._id_institucion
            }
        });





    },

    onBtnAgregarCarnetsColClick: function(button, e, eOpts) {

        records = Ext.getCmp('GridAlumnosRefer').getSelectionModel().getSelection();

        if(records.length > 0){
            var WinCuotasInscripcion = Ext.create('cartera.view.ReferenciasWin'),
                EditForm = WinCuotasInscripcion.down('form'),
                record = records[0],
                form = Ext.getCmp('formReferencias');

            WinCuotasInscripcion.setTitle('Asignar Referencias');
            form.getForm().loadRecord(record);
            //Ext.getCmp('institucionescmb').disabled=true;

        }else{
            Ext.MessageBox.show({
                title : 'Advertencia',
                buttons : Ext.MessageBox.OK,
                msg : 'Seleccione registro.',
                icon : Ext.Msg.ERROR

            });

        }


    },

    onGridcolumnAfterRender11: function(component, eOpts) {

    }

});
